clear

k = [1326.92 240.39 596.15 48.08 -1259.62 -48.08 -663.46 -240.39;
	 0.00 4500.00 -48.08 2230.77 48.08 -4480.77 -240.39 -2250.00;
	 0.00 0.00 1326.92 -240.39  -663.46 240.39 -1259.62 48.08;
	 0.00 0.00 0.00 4500.00  240.39 -2250.00 -48.08 -4480.77;
	 0.00 0.00 0.00 0.00 1326.92 -240.39 596.15 -48.08;
	 0.00 0.00 0.00 0.00 0.00 4500.00 48.08 2230.77;
	 0.00 0.00 0.00 0.00 0.00 0.00 1326.92 240.39;
	 0.00 0.00 0.00 0.00 0.00 0.00 0.00 4500.00];

for (i=1:8)
  for (j = i+1:8)
    k(j,i) = k(i,j);
  end
end

  kg = zeros(48,48);
F = zeros(40,1); F(40,1) = -0.1;
mesh = [ 0,1,6,7;
	 1,2,7,8;
	 2,3,9,8;
	 3,4,10,9;
	 4,5,11,10
	 6,7,13,12;
	 7,8,14,13
	 8,9,15,14;
	 9,10,16,15;
	 10,11,17,16;
	 12,13,19,18;
	 13,14,19,20;
	 14,15,21,20;
	 15,16,22,21;
	 16,17,23,22];

mesh = sort(mesh,2);
for i = 1:15
  kg = global2(mesh(i,:), k,kg);
end

kg_old = kg;

kg([1,2,13,14,25,26,37,38],:) = [];
kg(:,[1,2,13,14,25,26,37,38]) = [];



function kg = global2(n,k,kg)
pos(1) = (n(1)+1)*2-1; pos(2) = (n(1)+1)*2;
pos(3) = (n(2)+1)*2-1; pos(4) = (n(2)+1)*2;
pos(5) = (n(3)+1)*2-1; pos(6) = (n(3)+1)*2;
pos(7) = (n(4)+1)*2-1; pos(8) = (n(4)+1)*2;
  for i=1:8
    for j =1:8
      kg(pos(i),pos(j)) = k(i,j) + kg(pos(i),pos(j));
    end
  end
end
  
